<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 3 - Grammar Rules</title>
    <link rel="stylesheet" href="/static/lesson3.css">
    <script>
        // Predefined Grammar Questions
            const grammarQuestions = [
        {
            question: "What is the correct form of the verb in: 'She ____ (go) to the market every day.'",
            options: ["go", "goes", "went", "gone"],
            answer: "goes"
        },
        {
            question: "What is the correct form of the verb in: 'They ____ (eat) lunch at 12:00 PM every day.'",
            options: ["eat", "eats", "ate", "eating"],
            answer: "eat"
        },
        {
            question: "Fill in the blank: 'I ____ (be) very happy to meet you.'",
            options: ["is", "am", "are", "was"],
            answer: "am"
        },
        {
            question: "What is the correct article in: 'He is ____ doctor.'",
            options: ["a", "an", "the", "none"],
            answer: "a"
        },
        {
            question: "What is the plural form of 'child'?",
            options: ["childs", "childrens", "children", "child"],
            answer: "children"
        },
        {
            question: "What is the past tense of 'run'?",
            options: ["ran", "run", "running", "runned"],
            answer: "ran"
        },
        {
            question: "Choose the correct sentence:",
            options: ["She don't like apples.", "She doesn't like apples.", "She likes not apples.", "She not likes apples."],
            answer: "She doesn't like apples."
        },
        {
            question: "What is the correct preposition: 'She is good ____ singing.'",
            options: ["at", "on", "in", "for"],
            answer: "at"
        },
        {
            question: "Which sentence uses the correct subject-verb agreement?",
            options: ["The team are playing well.", "The team is playing well.", "The team be playing well.", "The team were playing well."],
            answer: "The team is playing well."
        },
        {
            question: "What is the correct form of 'to be' in: 'We ____ going to the park.'",
            options: ["are", "is", "am", "was"],
            answer: "are"
        },
        {
            question: "What is the past tense of 'write'?",
            options: ["wrote", "written", "write", "writing"],
            answer: "wrote"
        },
        {
            question: "Choose the correct sentence:",
            options: ["I has two dogs.", "I have two dogs.", "I haves two dogs.", "I is having two dogs."],
            answer: "I have two dogs."
        },
        {
            question: "Fill in the blank: 'She ____ (not have) any money.'",
            options: ["do not have", "does not have", "does not has", "do not has"],
            answer: "does not have"
        },
        {
            question: "Choose the correct form: 'We ____ (be) late for the meeting.'",
            options: ["were", "was", "is", "are"],
            answer: "were"
        },
        {
            question: "What is the plural form of 'mouse'?",
            options: ["mice", "mouses", "mouse", "mouseys"],
            answer: "mice"
        }
    ];

        let currentQuestionIndex = 0;
        let score = 0; // Track the user's score
        const totalQuestions = grammarQuestions.length;

        // Shuffle the questions array
        function shuffleQuestions(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Shuffle the questions before starting
        shuffleQuestions(grammarQuestions);

        // Load Grammar Question
        function loadQuestion() {
            const questionContainer = document.getElementById("question");
            const optionsContainer = document.getElementById("options-container");
            const inputContainer = document.getElementById("input-container");
            const question = grammarQuestions[currentQuestionIndex];

            questionContainer.textContent = question.question;

            // Clear and add new options
            optionsContainer.innerHTML = "";
            question.options.forEach((option, index) => {
                optionsContainer.innerHTML += `
                    <div class="option" onclick="checkAnswer('${option}', 'choose')">
                        ${String.fromCharCode(65 + index)}. ${option}
                    </div>
                `;
            });

            // Clear and add input option
            inputContainer.innerHTML = `
                <input type="text" id="userAnswer" class="answer-input" placeholder="Or type your answer here...">
                <button onclick="checkAnswer(document.getElementById('userAnswer').value, 'type')">Submit Answer</button>
            `;
        }

        // Check the selected or typed answer
        function checkAnswer(selectedAnswer, method) {
            const correctAnswer = grammarQuestions[currentQuestionIndex].answer.toLowerCase();
            const userAnswer = selectedAnswer.trim().toLowerCase();

            if (userAnswer === correctAnswer) {
                score++; // Increment score for correct answer
                alert("Correct!");
            } else {
                const feedback =
                    method === "choose"
                        ? "Incorrect. Try typing the correct answer below."
                        : `Incorrect. The correct answer is: ${grammarQuestions[currentQuestionIndex].answer}`;
                alert(feedback);
            }

            // Move to the next question or show score
            currentQuestionIndex++;
            if (currentQuestionIndex < grammarQuestions.length) {
                loadQuestion(); // Load next question
            } else {
                showScore(); // Show final score
            }
        }

        // Show the user's score
        function showScore() {
            const questionSection = document.getElementById("question-section");
            questionSection.innerHTML = `
                <div class="score-section">
                    <h2>Your Score</h2>
                    <p>You scored ${score} out of ${totalQuestions}.</p>
                    <a href="#" onclick="restartQuiz()" class="restart-button">Restart Quiz</a>
                </div>
            `;
        }

        // Restart the quiz
        function restartQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            loadQuestion();
        }

        // Initialize the quiz
        window.onload = () => {
            loadQuestion(); // Load the first question
        };
    </script>
</head>
<body>
    <header class="test-header">
        <h1>Lesson 3: Grammar Rules</h1>
    </header>
    <main class="test-content">
        <section id="question-section">
            <h2 id="question"></h2>
            <div id="options-container" class="options-container"></div>
            <div id="input-container"></div>
        </section>
    </main>
    <footer class="test-footer">
        <a href="{{ url_for('home') }}" class="back-button">Back to Home</a>
    </footer>

    <style>
        .test-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .test-content {
            width: 80%;
            margin: auto;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .option {
            padding: 10px 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            background: #f9f9f9;
            transition: all 0.3s;
        }

        .option:hover {
            background: #e0e0e0;
            transform: scale(1.02);
        }

        .answer-input {
            width: calc(100% - 20px);
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .answer-input:focus {
            outline: none;
            border-color: #007bff;
        }

        .score-section {
            text-align: center;
        }

        .back-button, .restart-button {
            display: inline-block;
            margin-top: 20px;
            text-decoration: none;
            padding: 10px 20px;
            background: #007bff;
            color: #fff;
            border-radius: 5px;
        }

        .back-button:hover, .restart-button:hover {
            background: #0056b3;
        }
    </style>
</body>
</html>
